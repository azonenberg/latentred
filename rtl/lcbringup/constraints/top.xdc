########################################################################################################################
# Pinout constraints
set_property PACKAGE_PIN W19 [get_ports clk_25mhz]
set_property IOSTANDARD LVCMOS33 [get_ports clk_25mhz]
set_property PACKAGE_PIN AB20 [get_ports {led[3]}]
set_property PACKAGE_PIN AA21 [get_ports {led[2]}]
set_property PACKAGE_PIN AB21 [get_ports {led[1]}]
set_property PACKAGE_PIN AB22 [get_ports {led[0]}]

set_property IOSTANDARD LVCMOS33 [get_ports {led[3]}]
set_property IOSTANDARD LVCMOS33 [get_ports {led[2]}]
set_property IOSTANDARD LVCMOS33 [get_ports {led[1]}]
set_property IOSTANDARD LVCMOS33 [get_ports {led[0]}]

set_property IOSTANDARD LVCMOS33 [get_ports {fmc_a_hi[9]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_a_hi[8]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_a_hi[7]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_a_hi[6]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_a_hi[5]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_a_hi[4]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_a_hi[3]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_a_hi[2]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_a_hi[1]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_a_hi[0]}]
set_property PACKAGE_PIN C22 [get_ports {fmc_a_hi[0]}]
set_property PACKAGE_PIN B22 [get_ports {fmc_a_hi[1]}]
set_property PACKAGE_PIN D21 [get_ports {fmc_a_hi[2]}]
set_property PACKAGE_PIN M22 [get_ports {fmc_a_hi[3]}]
set_property PACKAGE_PIN N22 [get_ports {fmc_a_hi[4]}]
set_property PACKAGE_PIN N20 [get_ports {fmc_a_hi[5]}]
set_property PACKAGE_PIN L19 [get_ports {fmc_a_hi[6]}]
set_property PACKAGE_PIN M21 [get_ports {fmc_a_hi[7]}]
set_property PACKAGE_PIN K21 [get_ports {fmc_a_hi[8]}]
set_property PACKAGE_PIN J22 [get_ports {fmc_a_hi[9]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_ad[15]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_ad[14]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_ad[13]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_ad[12]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_ad[11]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_ad[10]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_ad[9]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_ad[8]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_ad[7]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_ad[6]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_ad[5]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_ad[4]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_ad[3]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_ad[2]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_ad[1]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_ad[0]}]
set_property PACKAGE_PIN A20 [get_ports {fmc_ad[15]}]
set_property PACKAGE_PIN A21 [get_ports {fmc_ad[14]}]
set_property PACKAGE_PIN B20 [get_ports {fmc_ad[13]}]
set_property PACKAGE_PIN B18 [get_ports {fmc_ad[12]}]
set_property PACKAGE_PIN A19 [get_ports {fmc_ad[11]}]
set_property PACKAGE_PIN B21 [get_ports {fmc_ad[10]}]
set_property PACKAGE_PIN L20 [get_ports {fmc_ad[9]}]
set_property PACKAGE_PIN A18 [get_ports {fmc_ad[8]}]
set_property PACKAGE_PIN B16 [get_ports {fmc_ad[7]}]
set_property PACKAGE_PIN B17 [get_ports {fmc_ad[6]}]
set_property PACKAGE_PIN D16 [get_ports {fmc_ad[5]}]
set_property PACKAGE_PIN A16 [get_ports {fmc_ad[4]}]
set_property PACKAGE_PIN H20 [get_ports {fmc_ad[3]}]
set_property PACKAGE_PIN H19 [get_ports {fmc_ad[2]}]
set_property PACKAGE_PIN E16 [get_ports {fmc_ad[1]}]
set_property PACKAGE_PIN D22 [get_ports {fmc_ad[0]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_nbl[1]}]
set_property IOSTANDARD LVCMOS33 [get_ports {fmc_nbl[0]}]
set_property PACKAGE_PIN K19 [get_ports {fmc_nbl[1]}]
set_property PACKAGE_PIN L21 [get_ports {fmc_nbl[0]}]
set_property IOSTANDARD LVCMOS33 [get_ports fmc_clk]
set_property IOSTANDARD LVCMOS33 [get_ports fmc_ne1]
set_property IOSTANDARD LVCMOS33 [get_ports fmc_ne2]
set_property IOSTANDARD LVCMOS33 [get_ports fmc_ne3]
set_property IOSTANDARD LVCMOS33 [get_ports fmc_nl_nadv]
set_property IOSTANDARD LVCMOS33 [get_ports fmc_noe]
set_property IOSTANDARD LVCMOS33 [get_ports fmc_nwait]
set_property IOSTANDARD LVCMOS33 [get_ports fmc_nwe]
set_property PACKAGE_PIN J19 [get_ports fmc_clk]
set_property PACKAGE_PIN E22 [get_ports fmc_ne1]
set_property PACKAGE_PIN E21 [get_ports fmc_ne3]
set_property PACKAGE_PIN K22 [get_ports fmc_nl_nadv]
set_property PACKAGE_PIN J21 [get_ports fmc_ne2]
set_property PACKAGE_PIN J20 [get_ports fmc_noe]
set_property PACKAGE_PIN G20 [get_ports fmc_nwait]
set_property PACKAGE_PIN H22 [get_ports fmc_nwe]

########################################################################################################################
# Clocks

create_clock -period 40.000 -name clk_25mhz -waveform {0.000 20.000} [get_ports clk_25mhz]
create_clock -period 7.273 -name fmc_clk -waveform {0.000 3.637} [get_ports fmc_clk]

########################################################################################################################
# CDC constraints

# Synchronizer max delays: 5 ns (200 MHz) is << 1 cycle of both clocks
set_max_delay -datapath_only -from [get_cells -hierarchical -filter { NAME =~  "*sync*" && NAME =~  "*a_ff*" }] -to [get_cells -hierarchical -filter { NAME =~  "*sync*" && NAME =~  "*reg_b*" }] 5.000
set_max_delay -from [get_cells -hierarchical -filter { NAME =~  "*sync*" && NAME =~  "*dout0_reg*" }] -to [get_cells -hierarchical -filter { NAME =~  "*sync*" && NAME =~  "*dout1_reg*" }] 5.000

# APB clock domain crossings: 5 ns (200 MHz) is << 1 cycle of both clocks
set_max_delay -datapath_only -from [get_cells -hierarchical -filter { NAME =~  "*apb_cdc*" }] -to [get_clocks pclk_raw] 5.000
set_max_delay -from [get_clocks pclk_raw] -to [get_cells -hierarchical -filter { NAME =~  "*apb_cdc*" }] 5.000

# Async clock domains
set_clock_groups -asynchronous -group [get_clocks clk_125mhz] -group [get_clocks pclk_raw]
set_clock_groups -asynchronous -group [get_clocks clk_25mhz] -group [get_clocks pclk_raw]

########################################################################################################################
# Put the timestamp in the bitstream USERCODE

set_property BITSTREAM.CONFIG.USR_ACCESS TIMESTAMP [current_design]

set_property IOSTANDARD LVCMOS33 [get_ports eth_mdc]
set_property IOSTANDARD LVCMOS25 [get_ports eth_mdio]

set_property PACKAGE_PIN W22 [get_ports eth_mdc]
set_property IOSTANDARD LVCMOS33 [get_ports mdio]
set_property IOSTANDARD LVCMOS33 [get_ports mdio_tx_en]
set_property PACKAGE_PIN V22 [get_ports mdio_tx_en]
set_property PACKAGE_PIN Y22 [get_ports mdio]
